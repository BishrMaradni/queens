BootStrap: docker
From: continuumio/miniconda3

%help
This is a singulariy container containing CentOs7 and Python 3.6 as well as necessary QUEENS dependencies to run the latter on a HPC cluster. Central elements are a copy of the Drivers class and the main_remote.py file.

%files
  ../pqueens /
  ../pqueens/post_post /
  ../pqueens/drivers /
  ../pqueens/database /
  ../pqueens/utils /
  ../requirements_remote.txt /
  ../setup_remote.py /
  ../pqueens/remote_main.py /

%labels
  Maintainer Jonas Nitzler
  Date 24.07.2019

%post
  export PATH=/opt/conda/bin:${PATH}
  conda update -y conda
  conda create -n QUEENS python=3.6
  . activate QUEENS
  cd /
  pip install -r requirements_remote.txt
  python setup_remote.py develop
  conda update --all

%runscript
  exec python pqueens/remote_main.py $@
